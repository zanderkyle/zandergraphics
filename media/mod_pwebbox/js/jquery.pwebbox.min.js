
/*!
 * @package     pwebbox
 * @version 	2.0.9
 *
 * @copyright   Copyright (C) 2015 Perfect Web. All rights reserved. http://www.perfect-web.co
 * @license     GNU General Public Licence http://www.gnu.org/licenses/gpl-3.0.html
 * 
 * jQuery 1.8+
 */
var pwebBoxes=pwebBoxes||[],pwebbox_l10n=pwebbox_l10n||{};(function(a){pwebBox=function(b){this.init(b)};pwebBox.prototype=(function(){return{constructor:pwebBox,defaults:{id:"",selector:"#pwebbox",selectorClass:".pwebbox",debug:false,bootstrap:2,openAuto:false,openDelay:0,maxAutoOpen:0,closeAuto:false,closeDelay:0,closeOther:true,layout:"slidebox",theme:"",position:"left",offsetPosition:"top",msgCloseDelay:10,togglerNameOpen:"",togglerNameClose:"",slideWidth:0,slideDuration:400,slideTransition:"swing",accordionDuration:500,accordionEaseIn:"easeInBack",accordionEaseOut:"easeOutBounce",modalBackdrop:true,modalClose:true,modalStyle:"default",modalEffect:"fade",modalEffectDuration:400,modalEaseIn:"easeInCubic",modalEaseOut:"easeOutCubic",cookieLifetime:30,cookiePath:"/",cookieDomain:"",onLoad:function(){},onOpen:function(){},onClose:function(){},onTrack:function(){}},status:0,hidden:true,timer:false,init:function(c){var f=this;this.options=a.extend({},this.defaults,c);this.options.selector=this.options.selector+this.options.id;this.options.selectorClass=this.options.selectorClass+this.options.id;this.element=a(this.options.selector);this.Content=a(this.options.selector+"_content");this.Toggler=a(this.options.selector+"_toggler");this.Box=a(this.options.selector+"_box");this.Container=a(this.options.selector+"_container");this.options.autoClose=(this.options.closeDelay>0)?true:false;this.options.tracked=false;this.options.openEvent="click";if(this.Box.hasClass("pweb-open-event-mouseenter")){this.options.openEvent="mouseenter"}this.options.closeEvent="click";if(this.Box.hasClass("pweb-close-event-mouseleave")){this.options.closeEvent="mouseleave"}a("a[href="+this.options.selector+"_toggler]").addClass((this.options.selector.replace("#",""))+"_toggler");if(this.options.layout=="slidebox"){this.element.appendTo(document.body);this.initSlidebox()}else{if(this.options.layout=="modal"){this.element.appendTo(document.body);if(!this.initModal()){return false}}else{if(this.options.layout=="accordion"){this.initAccordion()}}}this.options.onLoad.apply(this);this.element.trigger("onLoad");var d=false;if(document.location.hash.indexOf(this.options.selector+":")!==-1){var g=document.location.hash.replace(this.options.selector+":","");if(g.indexOf("open")===0&&(typeof g[4]==="undefined"||g[4]==":")){g=g.replace(/open(:)?/i,"");d=true}}if(this.options.layout!="static"){if(this.options.openEvent=="click"&&this.options.closeEvent=="click"){a(this.options.selectorClass+"_toggler").click(function(h){h.preventDefault();f.toggleBox(-1,-1,this,h)})}else{this.Box.find(".pweb-button-close").click(function(h){h.preventDefault();f.toggleBox(-1,-1,this,h)});if(this.options.openEvent=="mouseenter"){a(this.Toggler).mouseenter(function(h){h.preventDefault();f.toggleBox(1,1,this,h)})}else{a(this.Toggler).click(function(h){h.preventDefault();f.toggleBox(1,1,this,h)})}if(this.options.closeEvent=="mouseleave"){var e=this.element;if(this.options.layout=="modal"){e=this.Box}a(e).mouseleave(function(h){if(f.Toggler.hasClass("pweb-opened")){h.preventDefault();f.toggleBox(0,-1,this,h)}})}else{a(this.Toggler).click(function(h){if(f.Toggler.hasClass("pweb-opened")){h.preventDefault();f.toggleBox(0,-1,this,h)}})}}if(this.options.togglerNameClose){this.options.togglerNameOpen=this.Toggler.find(".pweb-text").text()}if(this.options.closeOther){pwebBoxes.push(this)}if(d){this.autoPopupOnPageLoad()}else{if(this.options.openAuto){if(this.options.maxAutoOpen>0){if(!this.initAutoPopupCookie()){this.options.openAuto=false}}switch(this.options.openAuto){case 1:this.autoPopupOnPageLoad();break;case 2:this.autoPopupOnPageScroll();break;case 3:this.autoPopupOnPageExit()}}}if(f.options.layout=="bottombar"){var b=a(f.options.selector).find(".pwebbox-container").outerHeight();f.Toggler.height(b).css("line-height",b+"px")}a(window).resize(function(){if(f.options.layout=="bottombar"){var h=a(f.options.selector).find(".pwebbox-container").outerHeight();f.Toggler.height(h).css("line-height",h+"px")}})}this.initHiddenFields();return this},initSlidebox:function(){var b=this;this.options.togglerSlide=this.Box.hasClass("pweb-toggler-slide");this.options.togglerHidden=this.Box.hasClass("pweb-toggler-hidden");this.options.slidePos=this.element.css("position");if(!this.options.slideWidth){this.options.slideWidth=parseInt(this.Box.css("max-width"))}this.Box.css("width",this.options.slideWidth);if(this.options.position=="left"||this.options.position=="right"){this.Box.css(this.options.position,-this.options.slideWidth);this.options.togglerWidth=this.options.togglerSlide?this.Toggler.outerWidth():0;this.options.togglerHeight=this.options.togglerSlide?parseInt(this.Box.css("top")):0;this.options.slideOffset=parseInt(this.element.css("top"));if(this.options.togglerSlide){this.Toggler.css(this.options.position=="left"?"right":"left",-this.Toggler.outerWidth())}}else{setTimeout(function(){b.Box.css(b.options.position,-b.Box.height())},100);this.options.togglerWidth=0;this.options.togglerHeight=this.options.togglerSlide?this.Toggler.outerHeight():0;this.options.slideOffset=0;if(this.options.togglerSlide){this.Toggler.css(this.options.position=="top"?"bottom":"top",-this.Toggler.outerHeight())}}this.Box.addClass("pweb-closed");setTimeout(function(){b.Box.removeClass("pweb-init")},100);if(this.options.togglerHidden){this.Toggler.fadeOut(0).removeClass("pweb-closed").addClass("pweb-opened");if(this.options.togglerNameClose){this.Toggler.find(".pweb-text").text(this.options.togglerNameClose)}}this.isFF=navigator.userAgent.indexOf("Gecko")!=-1;a(window).scroll(function(c){if(!b.hidden&&b.element.css("position")=="absolute"&&b.options.slidePos=="fixed"){var d=a(this).scrollTop();if(b.options.position=="bottom"){d=d+a(this).height();if(d>b.element.offset().top){if(b.isFF){b.element.css("top",d)}else{b.element.stop().animate({top:d},250,"linear")}}}else{d=d+b.options.slideOffset;if(d<b.element.offset().top){if(b.isFF){b.element.css("top",d)}else{b.element.stop().animate({top:d},250,"linear")}}}}});a(window).resize(function(){if(!b.hidden){var c={width:b.options.slideWidth};var d=a(window).width();if(b.options.position=="left"||b.options.position=="right"){if(b.options.slideWidth+b.options.togglerWidth>d){c.width=d-b.options.togglerWidth}}else{var e=b.element.offset().left;if(b.options.offsetPosition=="right"){e=a(document).width()-e}if(b.options.slideWidth+e>d){c.width=d-e}}b.Box.css(c);if(b.options.slidePos=="fixed"){var c={position:"absolute"};if(b.options.position=="left"||b.options.position=="right"){c.top=b.element.offset().top;if(b.Box.height()+b.options.togglerHeight+c.top-a(window).scrollTop()<=a(window).height()){c.position="fixed";c.top=b.options.slideOffset}}else{if(b.Box.height()+b.options.togglerHeight>a(window).height()){c.top=b.element.offset().top;if(b.options.position=="bottom"){c.bottom="auto"}}else{c.position="fixed";c[b.options.position]=0;if(b.options.position=="bottom"){c.top="auto"}}}b.element.css(c)}}})},initModal:function(){var b=this;if(typeof a.fn.modal==="function"){this.Modal=a(this.options.selector+"_modal");this.options.modalClass="pwebbox"+this.options.id+"_modal-open pweb-modal-open"+(this.options.theme?" pweb-theme-"+this.options.theme+"-modal":"")+" pweb-modal-"+this.options.modalStyle;this.Modal.appendTo(document.body).modal({show:false,keyboard:false,backdrop:!this.options.modalClose&&this.options.modalBackdrop?"static":this.options.modalBackdrop}).on(this.options.bootstrap===2?"hidden":"hidden.bs.modal",function(c){c.stopPropagation();if(c.target!==c.currentTarget){return}b.toggleBox(0);a(document.body).removeClass(b.options.modalClass);b.Box.addClass("pweb-closed")}).on(this.options.bootstrap===2?"show":"show.bs.modal",function(c){c.stopPropagation();if(c.target!==c.currentTarget){return}a(document.body).addClass(b.options.modalClass);b.Box.removeClass("pweb-closed")}).click(function(c){if(c.target!==c.currentTarget||!b.options.modalClose){return}b.toggleBox(0)});if(this.options.modalEffect!=="fade"&&this.options.modalEffect!=="drop"){this.initGenie()}return true}else{if(this.options.debug){this.debug("Bootstrap Modal Plugin is not loaded")}}return false},initGenie:function(){var b=this,c=this.Box.attr("class").match(/pweb-bg-[a-z]+/i);this.options.modalGenieClass="pweb-genie pweb-"+this.options.modalEffect+"-"+(this.options.position!=="static"?this.options.position:"bottom")+" pwebbox"+this.options.id+"-genie"+(this.options.theme?" pweb-theme-"+this.options.theme:"")+(this.Box.hasClass("pweb-radius")?" pweb-radius":"")+(this.Box.hasClass("pweb-shadow")?" pweb-shadow":"")+(c?" "+c[0]:"");if(this.options.modalEffect==="smooth"){this.options.modalEaseIn="easeInQuart";this.options.modalEaseOut="easeOutQuart"}else{if(this.options.modalEffect==="rotate"){this.options.modalEaseIn="easeInQuint";this.options.modalEaseOut="easeOutQuint"}}this.Modal.on(this.options.bootstrap===2?"show":"show.bs.modal",function(d){d.stopPropagation();if(d.target!==d.currentTarget){return}if(typeof b.eventSource!=="undefined"&&a(b.eventSource).length){b.Container.css({visibility:"hidden",opacity:0})}}).on(this.options.bootstrap===2?"shown":"shown.bs.modal",function(d){d.stopPropagation();if(d.target!==d.currentTarget){return}if(typeof b.eventSource!=="undefined"&&a(b.eventSource).length){a(b.eventSource).trigger("modalOpen")}});a(this.options.selectorClass+"_toggler").on("modalOpen",function(){a(this).effect({effect:"transfer",to:b.Container,duration:b.options.modalEffectDuration,easing:b.options.modalEaseIn,className:"pweb-genie-show "+b.options.modalGenieClass,complete:function(){b.Container.css({visibility:"visible",opacity:1})}})});this.Container.on("modalClose",function(){a(this).css({visibility:"hidden",opacity:0}).effect({effect:"transfer",to:a(b.eventSource),duration:b.options.modalEffectDuration,easing:b.options.modalEaseOut,className:"pweb-genie-hide "+b.options.modalGenieClass,complete:function(){b.Modal.modal("hide")}})})},initAccordion:function(){var b=this;a(this.options.selectorClass+"_toggler").on("openAccordion",function(){b.Box.removeClass("pweb-closed").slideDown({duration:b.options.accordionDuration,easing:b.options.accordionEaseOut,complete:function(){var c=a(window).height(),e=b.element.outerHeight(),d=b.element.offset().top;if(d+e>a(window).scrollTop()+c){if(e<c){d=d+e-c}a("html,body").animate({scrollTop:parseInt(d)},500)}a(b.Toggler).trigger("openedAccordion")}})});a(this.element).on("closeAccordion",function(){b.Box.slideUp({duration:b.options.accordionDuration,easing:b.options.accordionEaseIn,complete:function(){b.Box.addClass("pweb-closed")}})});this.Box.css("display","none").removeClass("pweb-init");return true},initHiddenFields:function(){a("<input/>",{type:"hidden",name:"screen_resolution",value:screen.width+"x"+screen.height}).appendTo(this.Content);if(this.options.debug){a("<input/>",{type:"hidden",name:"debug",value:1}).appendTo(this.Content)}return true},close:function(){this.toggleBox(0)},toggleBox:function(g,f,i,e){var d=this;if(typeof g==="undefined"){g=-1}if(typeof i==="undefined"){i=this.Toggler}if(!this.hidden&&(g===-1||g===0)){this.hidden=true;if(this.Toggler.length&&!this.options.togglerHidden){this.Toggler.removeClass("pweb-opened").addClass("pweb-closed");if(this.options.togglerNameClose){this.Toggler.find(".pweb-text").text(this.options.togglerNameOpen)}}if(this.options.openAuto===false&&this.timer){clearTimeout(this.timer)}if(this.options.layout=="slidebox"){var b={};b[this.options.position]=(this.options.position=="left"||this.options.position=="right")?-this.Box.width():-this.Box.height();this.Box.stop(true,false).animate(b,this.options.slideDuration,this.options.slideTransition,function(){d.Box.addClass("pweb-closed");if(d.element.css("position")=="absolute"&&d.options.slidePos=="fixed"){var j={position:"fixed"};if(d.options.position=="left"||d.options.position=="right"){j.top=d.options.slideOffset}else{j[d.options.position]=0;if(d.options.position=="bottom"){j.top="auto"}}d.element.css(j)}a(i).trigger("closedSlidebox")});if(this.options.togglerHidden){this.Toggler.fadeOut(this.options.slideDuration)}}else{if(this.options.layout=="modal"){if(this.options.modalEffect!=="fade"&&this.options.modalEffect!=="drop"&&typeof this.eventSource!=="undefined"){this.Container.trigger("modalClose")}else{this.Modal.modal("hide")}}else{if(this.options.layout=="accordion"){a(i).trigger("closeAccordion")}else{if(this.options.layout=="bottombar"){this.element.hide()}}}}this.options.onClose.apply(this);this.element.trigger("onClose")}else{if(this.hidden&&(g===-1||g===1)){if(this.options.closeOther){a.each(pwebBoxes,function(){if(this.options.id!=d.options.id&&typeof this.close==="function"){this.close()}})}if(this.options.openAuto===1||this.options.openAuto===2){this.options.openAuto=false;if(this.timer){clearTimeout(this.timer)}}this.hidden=false;if(this.Toggler.length&&!this.options.togglerHidden){this.Toggler.removeClass("pweb-closed").addClass("pweb-opened");if(this.options.togglerNameClose){this.Toggler.find(".pweb-text").text(this.options.togglerNameClose)}}if(this.options.layout=="slidebox"){var b={width:this.options.slideWidth};b[this.options.position]=0;var c=a(window).width();if(this.options.position=="left"||this.options.position=="right"){if(this.options.slideWidth+this.options.togglerWidth>c){b.width=c-this.options.togglerWidth}}else{var h=this.element.offset().left;if(this.options.offsetPosition=="right"){h=a(document).width()-h}if(this.options.slideWidth+h>c){b.width=c-h}}this.Box.stop(true,false).animate(b,this.options.slideDuration,this.options.slideTransition,function(){if(d.options.slidePos=="fixed"){var j={position:"absolute"};if(d.options.position=="left"||d.options.position=="right"){j.top=d.element.offset().top;if(d.Box.height()+d.options.togglerHeight+j.top-a(window).scrollTop()>a(window).height()){j.top=d.element.offset().top;d.element.css(j)}}else{if(d.Box.height()+d.options.togglerHeight>a(window).height()){j.top=d.element.offset().top;if(d.options.position=="bottom"){j.bottom="auto"}d.element.css(j)}}}a(i).trigger("shownSlidebox")}).css("overflow","visible").removeClass("pweb-closed");if(this.options.togglerHidden){this.Toggler.fadeIn(this.options.slideDuration)}}else{if(this.options.layout=="modal"){if(this.options.modalEffect!=="fade"&&this.options.modalEffect!=="drop"&&a(i).length){this.eventSource=i}this.Modal.modal("show")}else{if(this.options.layout=="accordion"){a(i).trigger("openAccordion")}else{if(this.options.layout=="bottombar"){this.Box.parent().show()}}}}this.options.onOpen.apply(this);this.element.trigger("onOpen");if(!this.options.tracked){this.options.tracked=true;this.options.onTrack.apply(this);this.element.trigger("onTrack")}this.autoClose()}}},initAutoPopupCookie:function(){if(typeof a.cookie==="function"){var b=parseInt(a.cookie("pwebbox"+this.options.id+"_openauto"));b=isNaN(b)?1:b+1;if(b<=this.options.maxAutoOpen){a.cookie("pwebbox"+this.options.id+"_openauto",b,{domain:this.options.cookieDomain,path:this.options.cookiePath,expires:this.options.cookieLifetime});return true}}else{if(this.options.debug){this.debug("jQuery Cookie Plugin is not loaded")}}return false},autoPopupOnPageLoad:function(){if(this.options.openDelay){this.timer=this.delay(this.toggleBox,this.options.openDelay,this,[1])}else{this.toggleBox(1)}},autoPopupOnPageScroll:function(){var b=this;this.autoOpen=true;a(window).scroll(function(){if(b.autoOpen){b.autoOpen=false;if(b.options.openDelay){b.timer=b.delay(b.toggleBox,b.options.openDelay,b,[1])}else{b.toggleBox(1)}}})},autoPopupOnPageExit:function(){var b=this;this.autoOpen=-1;a(window).mousemove(function(c){if(b.autoOpen==-1&&c.clientY>70){b.autoOpen=1}else{if(b.autoOpen==1&&c.clientY<30){b.autoOpen=0;if(b.options.openDelay){b.timer=b.delay(b.toggleBox,b.options.openDelay,b,[1])}else{b.toggleBox(1)}}}})},autoClose:function(){if(this.options.autoClose){this.options.autoClose=false;if(this.options.closeDelay){this.timer=this.delay(this.toggleBox,this.options.closeDelay,this,[0])}else{this.toggleBox(0)}}},delay:function(d,c,e,b){return setTimeout(function(){return d.apply(e,b||arguments)},c)},displayAlert:function(b,c,e,f){if(typeof a.fn.alert==="function"){var d=a('<div class="pweb-alert alert alert-block '+(c?"alert-"+c:"")+' fade in"><button data-dismiss="alert" class="close" type="button">&times;</button>'+(typeof e!=="undefined"?'<h4 class="alert-heading">'+e+"</h4>":"")+"<p>"+b+"</p></div>").alert().appendTo(document.body);if((typeof f==="undefined"||f)&&this.options.msgCloseDelay){setTimeout(function(){d.alert("close")},this.options.msgCloseDelay*1000)}}else{alert(b.replace("<br>","\r\n"))}},debug:function(b,c){if(a.isArray(b)){b=b.join("<br>")}if(typeof c!=="undefined"){b=b+"<br>Response code: "+c}this.displayAlert(b,"info","Perfect Popup Box",false)}}})();pwebBox.options=pwebBox.prototype.options})(window.jQuery);